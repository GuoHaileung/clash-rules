# ======================
# åŸºç¡€ç«¯å£è®¾ç½®
# ======================
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893

allow-lan: false
bind-address: 127.0.0.1
mode: Rule
log-level: info
external-controller: 127.0.0.1:9090

# å…³ IPv6ï¼Œæ›´ç¨³
ipv6: false

# ======================
# Sniffer
# ======================
sniffer:
  enable: true
  parse-pure-ip: true  # å¤„ç†çº¯ IP è¯·æ±‚
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - "+.push.apple.com"
  skip-src-address:
    - 192.168.1.1/24
  skip-dst-address:
    - 91.105.192.0/23
    - 91.108.4.0/22
    - 91.108.8.0/21
    - 91.108.16.0/21
    - 91.108.56.0/22
    - 95.161.64.0/20
    - 149.154.160.0/20
    - 185.76.151.0/24
    - 2001:67c:4e8::/48
    - 2001:b28:f23c::/47
    - 2001:b28:f23f::/48
    - 2a0a:f280:203::/48
    
# ======================
# GeoData
# ======================
geodata-mode: true
geodata-loader: memconservative
geo-auto-update: true
geo-update-interval: 360
geox-url:
  geoip: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"
  asn: "https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/GeoLite2-ASN.mmdb"

# ======================
# å…¥ç«™
# ======================
#tun:
#  enable: true
#  # system/gvisor/mixed
#  stack: system
#  dns-hijack: ["any:53", "tcp://any:53"]
#  mtu: 1500
#  auto-route: true
#  auto-redirect: true
#  auto-detect-interface: true

# ======================
# DNSï¼ˆfake-ipï¼‰
# ======================
dns:
  enable: true
  listen: "0.0.0.0:1053"
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  use-hosts: true

  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
    - 114.114.114.114
    - 8.8.8.8

  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
    - https://dns.google/dns-query

  fake-ip-filter:
    - "*.lan"
    - "*.linksys.com"
    - "*.local"
    - "*.home.arpa"
    - swscan.apple.com
    - mesu.apple.com
    - swquery.apple.com
    - swdownload.apple.com
    - swcdn.apple.com
    - swdist.apple.com
    - "*.msftconnecttest.com"
    - "*.msftncsi.com"
    - "xbox.*.microsoft.com"
    - "xbox.*.*.microsoft.com"
    - "+.xboxlive.com"
    - "time.*.com"
    - "time.*.gov"
    - "time.*.edu.cn"
    - "time.*.apple.com"
    - "time1.*.com"
    - "time2.*.com"
    - "time3.*.com"
    - "time4.*.com"
    - "time5.*.com"
    - "time6.*.com"
    - "time7.*.com"
    - "ntp.*.com"
    - "ntp1.*.com"
    - "ntp2.*.com"
    - "ntp3.*.com"
    - "ntp4.*.com"
    - "ntp5.*.com"
    - "ntp6.*.com"
    - "ntp7.*.com"
    - "*.time.edu.cn"
    - "*.ntp.org.cn"
    - "+.pool.ntp.org"
    - "time1.cloud.tencent.com"
    - "lens.l.google.com"
    - "+.music.163.com"
    - "+.126.net"
    - "musicapi.taihe.com"
    - "music.taihe.com"
    - "songsearch.kugou.com"
    - "trackercdn.kugou.com"
    - "*.kuwo.cn"
    - "api-jooxtt.sanook.com"
    - "api.joox.com"
    - "joox.com"
    - "+.y.qq.com"
    - "+.music.tc.qq.com"
    - "aqqmusic.tc.qq.com"
    - "+.stream.qqmusic.qq.com"
    - "+.xiami.com"
    - "+.music.migu.cn"
    - "+.srv.nintendo.net"
    - "*.n.n.srv.nintendo.net"
    - "+.stun.playstation.net"
    - "+.battlenet.com.cn"
    - "+.wotgame.cn"
    - "+.wggames.cn"
    - "+.wowsgame.cn"
    - "+.wargaming.net"
    - "*.square-enix.com"
    - "*.finalfantasyxiv.com"
    - "*.ffxiv.com"
    - "*.ff14.sdo.com"
    - "ff.dorado.sdo.com"
    - "localhost.ptlogin2.qq.com"
    - "localhost.sec.qq.com"
    - "proxy.golang.org"
    - "+.qq.com"
    - "+.baidu.com"
    - "+.163.com"
    - "+.126.net"
    - "+.taobao.com"
    - "+.jd.com"
    - "+.tmall.com"
    - "*.mcdn.bilivideo.cn"
    - "+.nvidia.com"
    - "+.nvidia.cn"
    - "+.nvgs.nvidia.com"
    - "+.nvgs.nvidia.cn"
    - "shark007.net"

# ======================
# ä½ çš„è®¢é˜…
# ======================
proxy-providers:
  Link:
    type: http
    url: "å¡«å†™è®¢é˜…é“¾æ¥"
    interval: 3600
    path: ./providers/Link.yaml
    health-check:
      enable: true
      interval: 600
      url: https://www.gstatic.com/generate_204
      
#ä»¥æ­¤ç±»æ¨
# Link2:
#   type: http
#   url: "å¡«å†™é“¾æ¥"
#   interval: 3600
#   path: ./providers/Link2.yaml
#   health-check:
#     enable: true
#     interval: 600
#     url: https://www.gstatic.com/generate_204

# ======================
# è®¢é˜…åªå†™å…¥è¿™é‡Œï¼šproxies
# ======================
proxies: []

# ======================
# ä½ çš„åˆ†ç»„
# ======================
proxy-groups:
# ---- ï¼ˆå« Paypalï¼‰ ----
  - name: NODE
    type: select
    use:
      - Link
#ä¾æ¬¡ç±»æ¨
#     - Link2 
    proxies:
      - DIRECT
      
  - name: ğŸ“¢ Telegram
    type: select
    proxies:
      - NODE
    use:
      - Link
      
  - name: ğŸ® Steam
    type: select
    proxies:
      - DIRECT
      - NODE
    use:
      - Link
      
  - name: ğŸ–¥ Microsoft
    type: select
    proxies:
      - DIRECT
      - NODE
    use:
      - Link
      
  - name: ğŸ Apple
    type: select
    proxies:
      - DIRECT
      - NODE
    use:
      - Link

  - name: ğŸ” Google
    type: select
    proxies:
      - NODE
    use:
      - Link

  - name: ğŸ¤– AI
    type: select
    proxies:
      - NODE
    use:
      - Link

  - name: ğŸ“½ï¸ Bilibili
    type: select
    proxies:
      - DIRECT
      - NODE
    use:
      - Link

  # ---- ç¤¾äº¤åª’ä½“ï¼ˆå« TikTokã€Facebookã€Instagramã€Redditã€Twitterã€Whatsappã€Lineã€Linkedinï¼‰ ----
  - name: ğŸŒ SOCIAL
    type: select
    proxies:
      - NODE
    use:
      - Link

  # ---- æµåª’ä½“åˆå¹¶ï¼ˆå« Netflixã€Disneyã€PrimeVideoã€HBOã€Abemaã€Bahamutã€DAZNã€BBCã€Twitchã€Spotifyï¼‰ ----
  - name: ğŸ¬ STREAM
    type: select
    proxies:
      - NODE
    use:
      - Link

  - name: FINAL
    type: select
    proxies:
      - NODE
      - DIRECT
    use:
      - Link

# ======================
# è§„åˆ™
# ======================
rule-providers:
  DIRECT:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/DIRECT.list"
    path: ./rules/DIRECT.yaml

  REJECT:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/REJECT.list"
    path: ./rules/REJECT.yaml

  NODE:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/NODE.list"
    path: ./rules/NODE.yaml

  Apple:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Apple.list"
    path: ./rules/Apple.yaml

  Microsoft:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Microsoft.list"
    path: ./rules/Microsoft.yaml

  Paypal:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Paypal.list"
    path: ./rules/Paypal.yaml

  Bilibili:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Bilibili.list"
    path: ./rules/Bilibili.yaml

  TikTok:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/TikTok.list"
    path: ./rules/TikTok.yaml

  AI:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/AI.list"
    path: ./rules/AI.yaml

  Steam:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Steam.list"
    path: ./rules/Steam.yaml

  Google:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Google.list"
    path: ./rules/Google.yaml

  Spotify:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Spotify.list"
    path: ./rules/Spotify.yaml

  Facebook:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Facebook.list"
    path: ./rules/Facebook.yaml

  Discord:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Discord.list"
    path: ./rules/Discord.yaml

  Telegram:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Telegram.list"
    path: ./rules/Telegram.yaml

  Whatsapp:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Whatsapp.list"
    path: ./rules/Whatsapp.yaml

  Line:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Line.list"
    path: ./rules/Line.yaml

  Linkedin:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Linkedin.list"
    path: ./rules/Linkedin.yaml

  Reddit:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Reddit.list"
    path: ./rules/Reddit.yaml

  Instagram:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Instagram.list"
    path: ./rules/Instagram.yaml

  Twitter:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Twitter.list"
    path: ./rules/Twitter.yaml

  Netflix:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Netflix.list"
    path: ./rules/Netflix.yaml

  Disney:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Disney.list"
    path: ./rules/Disney.yaml

  PrimeVideo:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/PrimeVideo.list"
    path: ./rules/PrimeVideo.yaml

  Twitch:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Twitch.list"
    path: ./rules/Twitch.yaml

  HBO:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/HBO.list"
    path: ./rules/HBO.yaml

  Abema:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Abema.list"
    path: ./rules/Abema.yaml

  Bahamut:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/Bahamut.list"
    path: ./rules/Bahamut.yaml

  BBC:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/BBC.list"
    path: ./rules/BBC.yaml

  DAZN:
    type: http
    behavior: classical
    interval: 86400
    format: 'text'
    url: "https://raw.githubusercontent.com/GuoHaileung/clash-rules/refs/heads/main/rulesNew/DAZN.list"
    path: ./rules/DAZN.yaml

rules:
  # DIRECT / REJECT / NODE
  - RULE-SET,DIRECT,DIRECT
  - RULE-SET,REJECT,REJECT
  - RULE-SET,NODE,NODE

  # Apple / Microsoft / Paypal
  - RULE-SET,Apple,ğŸ Apple
  - RULE-SET,Microsoft,ğŸ–¥ Microsoft
  - RULE-SET,Paypal,NODE

  # Bilibili / TikTok / Steam / AI / Google / Telegram
  - RULE-SET,Bilibili,ğŸ“½ï¸ Bilibili
  - RULE-SET,AI,ğŸ¤– AI
  - RULE-SET,Steam,ğŸ® Steam
  - RULE-SET,Google,ğŸ” Google
  - RULE-SET,Telegram,ğŸ“¢ Telegram

  # å…¶ä»–ï¼šSpotify / TikTok
  - RULE-SET,Spotify,ğŸ¬ STREAM
  - RULE-SET,TikTok,ğŸŒ SOCIAL

  # ç¤¾äº¤å¹³å° â†’ SOCIAL
  - RULE-SET,Facebook,ğŸŒ SOCIAL
  - RULE-SET,Discord,ğŸŒ SOCIAL
  - RULE-SET,Whatsapp,ğŸŒ SOCIAL
  - RULE-SET,Line,ğŸŒ SOCIAL
  - RULE-SET,Linkedin,ğŸŒ SOCIAL
  - RULE-SET,Reddit,ğŸŒ SOCIAL
  - RULE-SET,Instagram,ğŸŒ SOCIAL
  - RULE-SET,Twitter,ğŸŒ SOCIAL
  
  # å„ç§æµåª’ä½“ â†’ STREAM
  - RULE-SET,Netflix,ğŸ¬ STREAM
  - RULE-SET,Disney,ğŸ¬ STREAM
  - RULE-SET,PrimeVideo,ğŸ¬ STREAM
  - RULE-SET,Twitch,ğŸ¬ STREAM
  - RULE-SET,HBO,ğŸ¬ STREAM
  - RULE-SET,Abema,ğŸ¬ STREAM
  - RULE-SET,Bahamut,ğŸ¬ STREAM
  - RULE-SET,BBC,ğŸ¬ STREAM
  - RULE-SET,DAZN,ğŸ¬ STREAM

  # builtin è§„åˆ™ï¼š
  - DOMAIN-SUFFIX,cn,DIRECT
  - DOMAIN-KEYWORD,-cn,DIRECT
  - GEOIP,CN,DIRECT

  # æœ€ç»ˆå…œåº•
  - MATCH,FINAL
